## 产品需求文档 (PRD): AstroZi Web3 冷启动功能

**版本**: 1.0  
**日期**: 2025年8月4日  
**作者**: GitHub Copilot

### 1. 概述

为推动 AstroZi Web3 版本的用户增长和社区活跃度，我们计划引入**积分排行榜 (Leaderboard)** 和**任务系统 (Task System)**。这两个功能将构成 Web3 冷启动的核心激励层，旨在提升用户活跃度、留存率，并为未来的社区建设和代币经济打下基础。

### 2. 目标与成功指标

| 目标 | 成功指标 |
| :--- | :--- |
| 提升用户活跃度 | 每日签到率提升 30% |
| 引导用户体验核心功能 | 新用户 7 日内完成核心任务（创建命盘、邀请好友）比例达到 50% |
| 激励社区竞争与互动 | 排行榜页面日均访问量 (DAU) 占总 DAU 的 20% 以上 |
| 增强空投预期 | 社区（Discord/Twitter）关于积分和排名的讨论量每周增长 15% |

### 3. 功能详述

#### 3.1. 功能一：积分排行榜 (Leaderboard)

**用户故事**:

*   作为一名 Web3 用户，我希望能看到自己的积分排名，以便了解我在社区中的位置，并激励我赚取更多积分。
*   作为一名社区成员，我想看到积分最高的顶级玩家，以了解社区的活跃度和竞争格局。

**功能需求**:

1.  **排行榜页面**:
    *   创建一个新的前端页面 `/leaderboard`。
    *   页面展示积分排名前 100 的用户列表。
    *   列表应包含：**排名、用户头像 (可选)、钱包地址 (部分打码)、总积分**。

2.  **“我的排名”模块**:
    *   在排行榜页面顶部，为已登录用户显示一个独立的模块，突出展示其**当前排名、钱包地址和总积分**。
    *   如果用户未进入前 100 名，此模块依然要正常显示。

3.  **数据更新**:
    *   排行榜数据应至少每小时更新一次，以保证信息的时效性。

4.  **API 需求**:
    *   **Endpoint**: `GET /api/points/leaderboard`
    *   **功能**: 返回积分排名前 100 的用户数据。
    *   **Endpoint**: `GET /api/points/my-rank`
    *   **功能**: 返回当前登录用户的排名和积分。

#### 3.2. 功能二：任务系统 (Task System) - 贡献者积累体系

**修正的用户故事**:

*   作为一名Web3用户，我希望通过完成任务来积累**贡献积分**，这些积分将成为我未来申请互助救助的**资格证明**。
*   作为一名长期用户，我希望我的每一个贡献行为都被记录在链上，包括命运预测、社区参与等，为未来的困难时刻建立**互助资格**。
*   作为生态贡献者，我期待我的付出能在真正需要时得到社区的支持和回报。

**功能需求**:

1.  **任务中心页面**:
    *   创建一个新的前端页面 `/tasks`。
    *   页面以卡片形式展示所有可完成的任务。
    *   每个任务卡片应包含：**任务标题、任务描述、积分奖励、任务状态 (未完成/已完成/去完成)**。

2.  **核心任务列表 (初版)**:
    *   **新手任务**:
        *   `每日签到`: 完成一次每日签到 (+10 积分)
        *   `创建命盘`: 成功创建你的第一个命盘 (+50 积分)
        *   `加入社区`: 点击链接访问 Discord/Twitter (+20 积分)
    *   **进阶任务**:
        *   `邀请好友`: 成功邀请一位好友注册并完成签到 (+100 积分)
        *   `连续签到`: 连续签到 7 天 (额外 +200 积分)

3.  **任务状态同步**:
    *   用户完成任务后，对应卡片状态应更新为“已完成”或“可领取”。
    *   用户点击“领取奖励”后，积分实时到账，卡片状态变为“已领取”。

4.  **API 需求**:
    *   **Endpoint**: `GET /api/tasks`
    *   **功能**: 返回所有任务列表及当前用户的完成状态。
    *   **Endpoint**: `POST /api/tasks/complete`
    *   **功能**: 前端在用户完成特定操作后调用此接口，后端验证并更新任务状态、发放积分。

### 4. 技术实现方案

*   **前端**: 使用 Next.js, React, Tailwind CSS 构建新页面。
*   **后端**: 在 `app/api/` 目录下创建新的 API 路由。
*   **数据库 (Supabase)**:
    *   **排行榜**: 对 `user_points` 表按 `points` 字段降序查询。
    *   **任务系统**: 新建 `tasks` 和 `user_tasks` 两张表来管理任务和用户进度。

### 5. 里程碑与排期

| 里程碑 | 预计完成时间 |
| :--- | :--- |
| **阶段一：后端开发** (API & 数据库) | 2025年8月11日 |
| **阶段二：前端开发** (页面 & 组件) | 2025年8月18日 |
| **阶段三：联调测试与上线** | 2025年8月22日 |
